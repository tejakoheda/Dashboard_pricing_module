<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Keycloak Popup Callback</title>
  </head>
  <body>
    <script>
      // The Keycloak redirect will land here with code/token in URL.
      // Notify the opener (parent window) that the redirect happened.
      try {
        if (window.opener && !window.opener.closed) {
          window.opener.postMessage({ type: "kc_popup_auth", url: location.href }, location.origin);
        }
      } catch (e) {
        // ignore
      }
      // close the popup
      window.close();

      // Fallback: if popup can't close automatically (blocked), show a message
      setTimeout(() => {
        document.body.innerHTML = "<p>Authentication complete. You can close this window.</p>";
      }, 500);
    </script>
  </body>
</html>
